<!DOCTYPE html>
<html>

<head>
    <title>Gym Diario</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
    <script>
        // Check for saved theme preference, otherwise use system preference
        const getPreferredTheme = () => {
            const storedTheme = localStorage.getItem('theme')
            if (storedTheme) {
                return storedTheme
            }
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
        }

        const setTheme = (theme) => {
            document.documentElement.setAttribute('data-theme', theme)
            localStorage.setItem('theme', theme)
            updateIcon(theme)
        }

        const updateIcon = (theme) => {
            const icon = document.getElementById('theme-toggle-icon')
            if (icon) {
                icon.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™'
            }
        }

        // Apply theme immediately
        setTheme(getPreferredTheme())

        window.addEventListener('DOMContentLoaded', () => {
            const toggleBtn = document.getElementById('theme-toggle')
            if (toggleBtn) {
                updateIcon(document.documentElement.getAttribute('data-theme'))
                toggleBtn.addEventListener('click', () => {
                    const currentTheme = document.documentElement.getAttribute('data-theme')
                    const newTheme = currentTheme === 'dark' ? 'light' : 'dark'
                    setTheme(newTheme)
                })
            }
        })
    </script>
</head>

<body>
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h1>ğŸ‹ï¸ Diario de Entrenamiento</h1>
            <div style="display: flex; align-items: center; gap: 15px;">
                {% if session.get('user_id') %}
                <span>Hola, <strong>{{ session.get('username') }}</strong></span>
                <a href="/logout" class="btn btn-danger" style="padding: 5px 10px; font-size: 0.9rem;">Salir</a>
                {% endif %}
                <button id="theme-toggle" class="btn btn-secondary"
                    style="padding: 5px 10px; font-size: 1.2rem; margin: 0;">
                    <span id="theme-toggle-icon">ğŸŒ™</span>
                </button>
            </div>
        </div>
        <hr>
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="alert-container">
            {% for message in messages %}
            <div class="alert">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}

        <footer class="page-footer">
            <a href="https://github.com/Master2415" target="_blank" rel="noopener noreferrer" class="github-link">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path
                        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                </svg>
                Master2415
            </a>
        </footer>
    </div>
</body>

</html>