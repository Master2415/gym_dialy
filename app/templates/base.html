<!DOCTYPE html>
<html>

<head>
    <title>Gym Diario</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ‹ï¸</text></svg>">
    <script>
        // ============================================
        // SISTEMA DE TEMAS
        // ============================================
        // Este script maneja la selecciÃ³n y persistencia de temas de color

        /**
         * Obtiene el tema preferido del usuario
         * Prioridad: 1) localStorage, 2) preferencia del sistema
         * @returns {string} Nombre del tema ('light', 'dark', 'blue', 'green', 'purple', 'amber')
         */
        const getPreferredTheme = () => {
            const storedTheme = localStorage.getItem('theme')
            if (storedTheme) {
                return storedTheme
            }
            // Si no hay tema guardado, usar la preferencia del sistema
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
        }

        /**
         * Aplica un tema al documento
         * @param {string} theme - Nombre del tema a aplicar
         */
        const setTheme = (theme) => {
            // Aplicar el tema mediante el atributo data-theme en el elemento raÃ­z
            document.documentElement.setAttribute('data-theme', theme)
            // Guardar la preferencia en localStorage para persistencia
            localStorage.setItem('theme', theme)
        }

        // Aplicar el tema inmediatamente al cargar la pÃ¡gina (antes del DOM)
        setTheme(getPreferredTheme())

        // ============================================
        // MENÃš DESPLEGABLE DE NAVEGACIÃ“N
        // ============================================
        // Configurar el menÃº de tres puntos cuando el DOM estÃ© listo
        window.addEventListener('DOMContentLoaded', () => {
            const settingsToggle = document.getElementById('settings-toggle')
            const dropdown = document.getElementById('settings-dropdown')

            // Solo configurar si ambos elementos existen (usuario autenticado)
            if (settingsToggle && dropdown) {
                // Alternar visibilidad del menÃº al hacer clic en el botÃ³n
                settingsToggle.addEventListener('click', (e) => {
                    e.stopPropagation() // Evitar que el clic se propague al documento
                    dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block'
                })

                // Cerrar el menÃº al hacer clic fuera de Ã©l
                document.addEventListener('click', () => {
                    dropdown.style.display = 'none'
                })

                // Evitar que clics dentro del menÃº lo cierren
                dropdown.addEventListener('click', (e) => {
                    e.stopPropagation()
                })
            }
        })
    </script>
</head>

<body>
    <div class="container">
        <!-- ============================================ -->
        <!-- ENCABEZADO Y NAVEGACIÃ“N PRINCIPAL -->
        <!-- ============================================ -->
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <!-- TÃ­tulo principal de la aplicaciÃ³n -->
            <h1>ğŸ‹ï¸ Diario de Entrenamiento</h1>

            <!-- Ãrea de usuario y menÃº (solo visible si hay sesiÃ³n activa) -->
            <div style="display: flex; align-items: center; gap: 15px;">
                {% if session.get('user_id') %}
                <!-- Saludo al usuario -->
                <span style="text-transform: uppercase;">Hola, <strong>{{ session.get('username') }}</strong></span>

                <!-- BotÃ³n de cerrar sesiÃ³n -->
                <a href="/logout" class="btn btn-danger" style="padding: 5px 10px; font-size: 0.9rem;">Salir</a>

                <!-- MenÃº desplegable de navegaciÃ³n (tres puntos) -->
                <div class="settings-menu">
                    <!-- BotÃ³n para abrir/cerrar el menÃº -->
                    <button id="settings-toggle" class="btn btn-secondary"
                        style="padding: 5px 10px; font-size: 1.2rem; margin: 0;">
                        <span>â‹®</span>
                    </button>

                    <!-- Contenido del menÃº desplegable -->
                    <div class="settings-dropdown" id="settings-dropdown">
                        <!-- Enlaces de navegaciÃ³n principales -->
                        <a href="/exercises">Gestionar Ejercicios</a>
                        <a href="/analytics">Ver Progreso</a>
                        <a href="/measurements">Mediciones</a>

                        <!-- Separador visual -->
                        <div style="border-top: 1px solid var(--border-color); margin: 5px 0;"></div>

                        <!-- Enlace a configuraciÃ³n -->
                        <a href="/settings">ConfiguraciÃ³n</a>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        <hr>

        <!-- ============================================ -->
        <!-- MENSAJES FLASH (notificaciones temporales) -->
        <!-- ============================================ -->
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="alert-container">
            {% for message in messages %}
            <div class="alert">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        <!-- ============================================ -->
        <!-- CONTENIDO PRINCIPAL DE LA PÃGINA -->
        <!-- ============================================ -->
        <!-- Este bloque serÃ¡ reemplazado por el contenido especÃ­fico de cada pÃ¡gina -->
        {% block content %}{% endblock %}


        <footer class="page-footer">
            <a href="https://github.com/Master2415" target="_blank" rel="noopener noreferrer" class="github-link">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path
                        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                </svg>
                Master2415
            </a>
        </footer>
    </div>
</body>

</html>